<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MESC Plots</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  </head>
  <body>

    <!-- Container for the first plot -->
    <div id="myPlot" style="width:100%; height:400px;"></div>

    <!-- Container for the second plot -->
    <div id="plot" style="width:100%; height:600px;"></div>

    <script>
      const jsonData = {"time":[0.000000,0.000050,0.000100,0.000150,0.000200,0.000250,0.000300,0.000350,0.000400,0.000450,0.000500,0.000550,0.000600,0.000650,0.000700,0.000750,0.000800,0.000850,0.000900,0.000950,0.001000,0.001050,0.001100,0.001150,0.001200,0.001250,0.001300,0.001350,0.001400,0.001450,0.001500,0.001550,0.001600,0.001650,0.001700,0.001750,0.001800,0.001850,0.001900,0.001950,0.002000,0.002050,0.002100,0.002150,0.002200,0.002250,0.002300,0.002350,0.002400,0.002450,0.002500,0.002550,0.002600,0.002650,0.002700,0.002750,0.002800,0.002850,0.002900,0.002950,0.003000,0.003050,0.003100,0.003150,0.003200,0.003250,0.003300,0.003350,0.003400,0.003450,0.003500,0.003550,0.003600,0.003650,0.003700,0.003750,0.003800,0.003850,0.003900,0.003950,0.004000,0.004050,0.004100,0.004150,0.004200,0.004250,0.004300,0.004350,0.004400,0.004450,0.004500,0.004550,0.004600,0.004650,0.004700,0.004750,0.004800,0.004850,0.004900,0.004950], "Vbus.V.y1":[54.19,54.16,54.16,54.19,54.12,54.08,54.08,54.16,54.12,54.01,54.04,54.12,54.16,54.04,54.12,54.12,54.16,54.16,54.08,54.08,54.08,54.12,54.16,54.12,54.12,54.12,54.12,54.12,54.08,54.12,54.12,54.08,54.12,54.12,54.16,54.16,54.12,54.12,54.16,54.12,54.12,54.12,54.01,54.12,54.12,54.12,54.16,54.19,54.16,54.19,54.12,54.12,54.16,54.08,54.08,54.12,54.19,54.12,54.16,54.16,54.12,54.12,54.12,54.12,54.12,54.04,54.08,54.08,54.08,54.08,54.08,54.12,54.08,54.12,54.12,54.04,54.16,54.08,54.12,54.08,54.12,54.08,54.16,54.12,54.08,54.12,54.08,54.08,54.08,54.08,54.04,54.08,54.08,54.04,54.12,54.08,54.04,54.08,54.08,54.08], "Iu.I_phase.y1":[1.23,0.53,0.06,-1.33,-1.33,-1.33,-1.33,-0.40,0.06,-0.17,-0.63,0.76,0.06,0.30,-0.17,-2.03,-2.03,-1.56,-0.87,-0.63,-0.40,0.30,0.30,1.23,0.76,1.23,0.30,-1.10,-0.87,-1.33,-0.87,0.30,-0.63,-1.10,-0.17,0.76,0.06,0.06,-0.87,-0.40,0.06,-0.17,0.30,0.53,0.76,0.76,1.46,1.23,0.76,0.99,-1.80,-1.80,-0.87,-1.33,0.06,-0.17,1.23,1.23,2.16,1.46,1.69,0.99,-0.63,-0.87,-1.56,-2.03,-1.10,-1.10,-1.10,-0.87,0.99,0.06,0.30,0.06,-1.10,-0.40,-1.10,-0.87,0.06,0.30,0.76,0.53,1.46,0.30,0.76,-0.40,-1.33,-0.63,-0.87,0.06,0.53,0.99,1.23,1.92,1.23,0.76,0.76,-1.56,-2.49,-2.73], "Iv.I_phase.y1":[0.48,-0.22,0.25,1.41,1.64,0.71,-0.22,-2.54,-2.31,-0.92,-0.68,-0.22,0.94,1.18,1.41,2.80,0.94,0.71,0.01,-1.15,-0.92,-0.45,-0.22,-0.22,0.48,-0.22,0.25,1.18,-0.22,-0.68,-2.78,-3.24,-1.15,-0.45,0.25,1.18,2.11,1.64,1.87,1.64,0.48,0.25,-2.08,-2.08,-1.85,-1.38,-0.45,0.25,0.25,0.01,0.94,1.87,1.18,0.48,-0.68,-0.92,-1.38,-1.38,-0.92,0.25,-0.45,-0.92,1.18,0.25,-0.22,-1.15,-2.54,-1.15,0.01,-0.45,0.71,0.71,0.01,0.71,1.87,0.25,-0.22,-2.08,-3.47,-2.78,-1.38,-0.92,0.48,0.48,-0.22,1.18,1.41,0.71,0.25,-2.08,-3.47,-3.47,-3.01,-1.15,-0.68,-1.38,-1.61,0.94,0.71,0.25], "Iw.I_phase.y1":[-1.22,-0.52,-0.76,-0.52,0.17,0.41,1.57,2.96,2.27,1.57,1.80,-0.99,-1.69,-1.45,-1.22,-0.76,-0.06,0.87,1.34,2.50,1.34,0.87,-0.06,-2.38,-1.92,-1.22,-0.99,-0.06,0.64,1.34,4.13,4.36,2.27,2.50,-0.29,-2.38,-2.15,-2.15,-1.45,-0.99,-0.52,-0.29,2.27,1.80,1.10,0.64,-1.45,-2.38,-1.22,-0.99,-0.52,-0.06,-0.06,-0.76,1.80,0.41,0.64,-0.06,-2.38,-1.92,-0.76,-0.52,-0.06,1.34,2.27,3.43,4.36,2.27,2.03,0.41,-2.15,-1.22,-0.52,-0.99,-0.52,-0.06,0.64,3.20,3.89,2.96,2.96,-0.06,-1.92,-1.22,-0.52,-0.76,-0.52,-0.06,0.41,2.96,3.20,1.34,0.64,-1.69,-1.22,0.41,0.17,0.64,1.80,2.73], "Vd.V_dq.y1":[6.36,6.12,6.22,6.32,6.27,6.16,6.26,6.46,6.23,6.07,5.84,6.28,6.39,6.30,6.21,6.28,6.12,6.18,6.17,6.20,6.07,6.20,6.20,6.33,6.21,5.98,6.07,6.24,6.29,6.44,6.61,6.47,6.00,5.64,6.27,6.54,6.57,6.31,6.24,6.06,6.11,6.18,6.57,6.40,6.24,6.12,6.39,6.32,6.17,6.03,6.39,6.23,6.11,6.11,6.32,6.18,6.34,6.21,6.35,6.25,6.01,6.00,6.26,6.51,6.55,6.38,6.29,5.94,5.96,6.12,6.51,6.35,6.21,6.16,6.20,6.19,6.34,6.51,6.43,6.10,5.58,6.13,6.38,6.23,6.05,6.19,6.12,6.11,6.14,6.49,6.35,6.05,6.08,6.29,6.06,5.88,6.00,6.44,6.56,6.52], "Vq.V_dq.y1":[25.34,25.49,25.43,25.20,25.30,25.33,25.25,24.93,25.00,25.40,25.71,25.35,25.30,25.30,25.30,24.98,25.09,25.25,25.39,25.21,25.35,25.52,25.58,25.01,25.18,25.41,25.45,25.36,25.48,25.27,24.89,24.84,25.29,25.73,25.65,25.24,25.21,25.10,25.10,25.37,25.65,25.65,25.30,25.21,25.26,25.39,25.24,25.07,25.38,25.54,25.14,25.18,25.46,25.39,25.53,25.43,25.37,25.33,24.92,25.19,25.52,25.71,25.54,25.62,25.31,25.00,24.84,25.27,25.73,25.66,25.31,25.46,25.62,25.51,25.38,25.66,25.47,25.14,24.86,25.04,25.60,25.48,25.30,25.44,25.67,25.48,25.33,25.60,25.57,25.32,24.92,24.93,24.98,25.02,25.23,25.75,25.84,25.50,25.28,25.07], "angle.misc.y1":[54802,60488,524,5970,11650,17272,22767,28053,33568,39347,45146,50525,56170,61832,1926,7253,12844,18452,24048,29431,35071,40749,46423,51628,57316,63034,3105,8649,14402,19904,25203,30581,36354,42144,47699,53110,58747,64224,4176,9831,15566,21205,26625,32229,37850,43506,48963,54420,60184,336,5605,11188,16935,22417,28119,33695,39270,44859,50114,55805,61536,1703,7219,12993,18478,23840,29172,34863,40603,46095,51474,57206,62948,2975,8513,14402,19968,25383,30727,36270,42072,47450,52899,58572,64352,4322,9864,15758,21449,26987,32338,37834,43262,48648,54337,60290,544,6093,11749,17306]}

      // First plot
      const Vbus = jsonData["Vbus.V.y1"];
      const Vd = jsonData["Vd.V_dq.y1"];
      const Vq = jsonData["Vq.V_dq.y1"];
      const angle = jsonData["angle.misc.y1"];

      const Vmax = Math.max(...Vbus) 
      const angle_max = Math.max(...angle) + (0.1 * Math.max(...angle))

      jsonData.time = jsonData.time.map(timeValue => timeValue * 10000);

      var trace1 = {
          x: jsonData.time,
          y: Vbus,
          type: 'scatter',
          name: 'Vbus',
          yaxis: 'y1'
      };

      var trace2 = {
          x: jsonData.time,
          y: Vd,
          type: 'scatter',
          name: 'Vd',
          yaxis: 'y1'
      };

      var trace3 = {
          x: jsonData.time,
          y: Vq,
          type: 'scatter',
          name: 'Vq',
          yaxis: 'y1'
      };

      var trace4 = {
          x: jsonData.time,
          y: angle,
          type: 'scatter',
          name: 'angle',
          yaxis: 'y2'
      };

      var data1 = [trace1, trace2, trace3, trace4];

      var layout1 = {
          title: 'MESC Plot: log -fl',
          // height: 600,
          width: 800,
          yaxis: {
              title: 'Vmax',
              range: [0, Vmax]
          },
          yaxis2: {
                title: 'angle',
                range: [0, angle_max],
                overlaying: 'y',
                side: 'right'
            },
          xaxis: {
              title: 'Time (ms)'
          },
          legend: {
              x: 1.05,
              y: 1
          }
      };
      Plotly.newPlot('myPlot', data1, layout1);

      // second plot
      const Iu = jsonData["Iu.I_phase.y1"];
      const Iv = jsonData["Iv.I_phase.y1"];
      const Iw = jsonData["Iw.I_phase.y1"];

      const trace_Iu = {
          x: jsonData.time,
          y: Iu,
          name: 'Iu',
          type: 'scatter'
      };

      const trace_Iv = {
          x: jsonData.time,
          y: Iv,
          name: 'Iv',
          type: 'scatter'
      };

      const trace_Iw = {
          x: jsonData.time,
          y: Iw,
          name: 'Iw',
          type: 'scatter'
      };

      var data2 = [trace_Iu, trace_Iv, trace_Iw];

      const layout2 = {
          xaxis: { title: 'Time (ms)' },
          yaxis: { 
              title: 'Phase Amps',
              side: 'left' 
          },
          height: 600,
          width: 800,
          legend: {
              x: 1.05,
              y: 1
          }
      };

      Plotly.newPlot('plot', data2, layout2);
    </script>
  </body>
</html>
